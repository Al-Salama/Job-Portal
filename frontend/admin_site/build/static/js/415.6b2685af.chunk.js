"use strict";(self.webpackChunkadmin_site=self.webpackChunkadmin_site||[]).push([[415],{496:function(e,t,n){n.d(t,{Z:function(){return c}});var s=n(433),r=n(439),a=n(791);function c(e){var t=(0,a.useState)(e),n=(0,r.Z)(t,2),c=n[0],i=n[1];return{array:c,set:i,push:function(e){i((function(t){return[].concat((0,s.Z)(t),[e])}))},filter:function(e){i((function(t){return t.filter(e)}))},update:function(e,t){i((function(n){return[].concat((0,s.Z)(n.slice(0,e)),[t],(0,s.Z)(n.slice(e+1,n.length)))}))},remove:function(e){i((function(t){return[].concat((0,s.Z)(t.slice(0,e)),(0,s.Z)(t.slice(e+1,t.length)))}))},clear:function(){i([])}}}},415:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var s=n(165),r=n(683),a=n(861),c=n(762),i=n(439),o=n(791),l=n(962),u=n(496),d=n(184);function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.prototype;return!Number.isNaN(e)&&Number.isFinite(e)}function f(e){var t=parseInt(this.dataset.id);p(t)?window.location.href="/submission?id=".concat(t):e.preventDefault()}function h(e){return m.apply(this,arguments)}function m(){return m=(0,a.Z)((0,s.Z)().mark((function e(t){var n,a,c,i,o,u,d=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>2&&void 0!==d[2]?d[2]:{},i=S(c=[{key:"appId",value:d.length>1&&void 0!==d[1]?d[1]:1}]),o="".concat(l.Z.api,"/submissions").concat(i),e.prev=5,e.next=8,fetch(o,{method:"GET",credentials:"include"});case 8:a=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),console.error(e.t0);case 14:if(e.prev=14,!a){e.next=34;break}return e.next=18,a.json();case 18:if(u=e.sent,!a.ok){e.next=29;break}k(c),n.setNewSubmissions((0,r.Z)((0,r.Z)({},u.submissions.new),{},{buttonId:"category-new"})),n.setAcceptedSubmissions((0,r.Z)((0,r.Z)({},u.submissions.accepted),{},{buttonId:"category-accepted"})),n.setPendingSubmissions((0,r.Z)((0,r.Z)({},u.submissions.pending),{},{buttonId:"category-pending"})),n.setRejectedSubmissions((0,r.Z)((0,r.Z)({},u.submissions.rejected),{},{buttonId:"category-rejected"})),u.applications=u.applications.map((function(e,t){var n=new Date;return n.setTime(Number(e.startDate)),(0,r.Z)((0,r.Z)({},e),{},{startDate:n.toLocaleDateString("ar-US",{year:"numeric",month:"long",day:"numeric"})})})),n.setApplications(u.applications),e.next=34;break;case 29:if(401!==a.status){e.next=32;break}return window.location.href="/login",e.abrupt("return");case 32:console.error("Error fetching submissions, error code:",a.status),console.error("Response:\n",u);case 34:return e.finish(14);case 35:case"end":return e.stop()}}),e,null,[[5,11,14,35]])}))),m.apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return g=(0,a.Z)((0,s.Z)().mark((function e(t){var n,a,c,i,o,u,d,f,h,m=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>1&&void 0!==m[1]?m[1]:[],a=(m.length>2&&void 0!==m[2]?m[2]:[]).find((function(e){return!0===e.selected})),c=n.getters.findIndex((function(e){return!0===e.selected})),p(i=parseInt(this.dataset.pageNumber))){e.next=7;break}return e.abrupt("return");case 7:return u="".concat(l.Z.api,"/submissions/").concat(a.id,"/").concat(c,"/pages/").concat(i),e.prev=8,e.next=11,fetch(u,{method:"GET",credentials:"include"});case 11:o=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),console.error(e.t0);case 17:if(e.prev=17,!o){e.next=37;break}return e.next=21,o.json();case 21:if(d=e.sent,!o.ok){e.next=32;break}n.setters[c]((0,r.Z)((0,r.Z)({},n.getters[c]),d.submissions)),f=new Proxy(new URLSearchParams(window.location.search),{get:function(e,t){return e.get(t)}}),h=[],f.appId&&h.push({key:"appId",value:a.id}),f.category&&h.push({key:"category",value:c}),i>1&&h.push({key:"page",value:i}),k(h),e.next=37;break;case 32:if(401!==o.status){e.next=35;break}return window.location.href="/login",e.abrupt("return");case 35:console.error("Error fetching submissions, error code:",o.status),console.error("Response:\n",d);case 37:return e.finish(17);case 38:case"end":return e.stop()}}),e,this,[[8,14,17,38]])}))),g.apply(this,arguments)}function v(e,t){var n,s;for(var a in t){var c,i;(null===(c=(s=t[a]).getter)||void 0===c?void 0:c.buttonId)===this.id?(this.classList.add("selected"),n=a,s.setter((0,r.Z)((0,r.Z)({},s.getter),{},{selected:!0}))):null!==(i=s.getter)&&void 0!==i&&i.selected&&(delete s.getter.selected,s.setter((0,r.Z)({},s.getter)))}var o=new Proxy(new URLSearchParams(window.location.search),{get:function(e,t){return e.get(t)}}).appId,l=[];o&&l.push({key:"appId",value:o}),l.push({key:"category",value:n}),k(l)}function y(e){var t,n,s,r,a;if(null!==(t=e.newSubmissions)&&void 0!==t&&t.selected?a=e.newSubmissions:null!==(n=e.acceptedSubmissions)&&void 0!==n&&n.selected?a=e.acceptedSubmissions:null!==(s=e.pendingSubmissions)&&void 0!==s&&s.selected?a=e.pendingSubmissions:null!==(r=e.rejectedSubmissions)&&void 0!==r&&r.selected&&(a=e.rejectedSubmissions),a){var c,i=(0,d.jsx)("button",{className:"prev-page","data-page-number":a.currentPage-1,disabled:a.currentPage<=1,children:"\u0627\u0644\u0633\u0627\u0628\u0642"});a.currentPage>1&&(i=(0,d.jsx)("button",{className:"prev-page","data-page-number":a.currentPage-1,children:"\u0627\u0644\u0633\u0627\u0628\u0642"}),c=(0,d.jsx)("button",{"data-page-number":"1",children:"1"}));var o,l=(0,d.jsx)("button",{className:"next-page","data-page-number":a.currentPage+1,disabled:a.currentPage>=a.totalPages,children:"\u0627\u0644\u062a\u0627\u0644\u064a"});return a.currentPage<a.totalPages&&(o=(0,d.jsx)("button",{"data-page-number":a.totalPages,children:a.totalPages})),(0,d.jsxs)("section",{className:"page-selector",children:[i,c,(0,d.jsx)("button",{"data-page-number":a.currentPage,className:"selected-page",children:a.currentPage}),o,l]})}}function x(e){var t=e.applications,n=e.categories;if(t.length<=0||!n[0]||!("rows"in n[0]))return null;var s={total:t.find((function(e){return!0===e.selected})).totalSubmissions,selectedCategory:n.find((function(e){return!0===e.selected})).count};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{children:(0,d.jsxs)("p",{children:[(0,d.jsx)("b",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0639\u062f\u062f \u0627\u0644\u062a\u0642\u062f\u064a\u0645\u0627\u062a:"})," ",s.total]})}),(0,d.jsx)("div",{children:(0,d.jsxs)("p",{children:[(0,d.jsx)("b",{children:"\u0639\u062f\u062f \u0627\u0644\u062a\u0642\u062f\u064a\u0645\u0627\u062a \u0641\u064a \u0627\u0644\u0642\u0633\u0645 \u0627\u0644\u0645\u062d\u062f\u062f:"})," ",s.selectedCategory]})})]})}function j(e){var t,n,s=(0,c.Z)(e);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(r&&r.selected){t=r.rows.map((function(e,t){return(0,d.jsxs)("tr",{"data-id":e.id,children:[(0,d.jsx)("td",{children:e.id}),(0,d.jsx)("td",{className:"spacing-cell"}),(0,d.jsx)("td",{children:e.name}),(0,d.jsx)("td",{className:"spacing-cell"}),(0,d.jsx)("td",{children:e.id_number})]},t)}));break}}}catch(a){s.e(a)}finally{s.f()}return(0,d.jsxs)("table",{className:"submissions",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"\u0627\u0644\u0631\u0642\u0645"}),(0,d.jsx)("th",{className:"spacing-cell"}),(0,d.jsx)("th",{children:"\u0627\u0644\u0625\u0633\u0645"}),(0,d.jsx)("th",{className:"spacing-cell"}),(0,d.jsx)("th",{children:"\u0631\u0642\u0645 \u0627\u0644\u0647\u0648\u064a\u0629"})]})}),(0,d.jsx)("tbody",{children:t})]})}function Z(e){var t,n;return e?(t=e.map((function(e,t){return(0,d.jsx)("option",{value:"".concat(e.id),children:"".concat(e.jobName," | ").concat(e.startDate).concat(e.closed?" [Closed]":"")},e.id)})),n=(0,d.jsx)("select",{id:"applications-select",children:t})):n=(0,d.jsx)("select",{id:"applications-select",defaultValue:"default",children:(0,d.jsx)("option",{value:"default",disabled:!0,children:"Loading ..."})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"applications-select",children:"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062a\u0642\u062f\u064a\u0645\u0627\u062a \u0627\u0644\u0645\u0633\u062c\u0644\u0629"}),n]})}function w(){return(w=(0,a.Z)((0,s.Z)().mark((function e(t){var n,a,c,i,o,u,d,p,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Proxy(new URLSearchParams(window.location.search),{get:function(e,t){return e.get(t)}}),c=a.appId,i=a.category,o=a.page,u=[],c&&u.push({key:"appId",value:c}),i&&u.push({key:"category",value:i}),o&&u.push({key:"page",value:o}),d=S(u),p="".concat(l.Z.api,"/submissions").concat(d),e.prev=10,e.next=13,fetch(p,{method:"GET",credentials:"include"});case 13:n=e.sent,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),console.error(e.t0);case 19:if(e.prev=19,!n){e.next=38;break}return e.next=23,n.json();case 23:if(f=e.sent,!n.ok){e.next=33;break}t.setNewSubmissions((0,r.Z)((0,r.Z)({},f.submissions.new),{},{buttonId:"category-new"})),t.setAcceptedSubmissions((0,r.Z)((0,r.Z)({},f.submissions.accepted),{},{buttonId:"category-accepted"})),t.setPendingSubmissions((0,r.Z)((0,r.Z)({},f.submissions.pending),{},{buttonId:"category-pending"})),t.setRejectedSubmissions((0,r.Z)((0,r.Z)({},f.submissions.rejected),{},{buttonId:"category-rejected"})),f.applications=f.applications.map((function(e,t){var n=new Date;return n.setTime(Number(e.startDate)),(0,r.Z)((0,r.Z)({},e),{},{startDate:n.toLocaleDateString("ar-US",{year:"numeric",month:"long",day:"numeric"})})})),t.setApplications(f.applications),e.next=38;break;case 33:if(401!==n.status){e.next=36;break}return window.location.href="/login",e.abrupt("return");case 36:console.error("Error fetching submissions, error code:",n.status),console.error("Response:\n",f);case 38:return e.finish(19);case 39:case"end":return e.stop()}}),e,null,[[10,16,19,39]])})))).apply(this,arguments)}function S(e){var t,n="",s=!0,r=(0,c.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n=n.concat(s?"?":"&").concat(a.key).concat("=").concat(a.value),s&&(s=!1)}}catch(i){r.e(i)}finally{r.f()}return n}function k(e){var t=S(e),n=window.location.origin+window.location.pathname+t;return window.history.pushState({path:n},"",n),t}var N=function(e){e.adminInfo;var t=(0,o.useState)(),n=(0,i.Z)(t,2),s=n[0],r=n[1],a=(0,o.useState)(),l=(0,i.Z)(a,2),m=l[0],g=l[1],S=(0,o.useState)(),k=(0,i.Z)(S,2),N=k[0],I=k[1],P=(0,o.useState)(),E=(0,i.Z)(P,2),L=E[0],A=E[1],D=(0,u.Z)(!1),R=(0,o.useRef)(!1);return(0,o.useEffect)((function(){R.current||(R.current=!0,function(e){w.apply(this,arguments)}({setNewSubmissions:r,setAcceptedSubmissions:g,setPendingSubmissions:I,setRejectedSubmissions:A,setApplications:D.set}))}),[]),(0,o.useEffect)((function(){if(Array.isArray(D.array)){var e=document.getElementById("applications-select"),t=D.array.findIndex((function(e){return!0===e.selected}));return console.log(t),"number"==typeof t&&(e.selectedIndex=t),e.addEventListener("change",n),function(){e.removeEventListener("change",n)}}function n(e){var t=parseInt(this.value);console.countReset("app seledct"),console.count("app seledct"),p(t)?(console.count("app seledct"),h.call(this,e,t,{setNewSubmissions:r,setAcceptedSubmissions:g,setPendingSubmissions:I,setRejectedSubmissions:A,setApplications:D.set})):e.preventDefault()}}),[D]),(0,o.useEffect)((function(){if(s&&m&&N&&L&&Array.isArray(D.array)){var e,t=document.querySelectorAll(".category-tabs button"),n=(0,c.Z)(t);try{for(n.s();!(e=n.n()).done;){e.value.addEventListener("click",p)}}catch(y){n.e(y)}finally{n.f()}var a,i=document.querySelectorAll(".Home .page-selector button"),o=(0,c.Z)(i);try{for(o.s();!(a=o.n()).done;){a.value.addEventListener("click",h)}}catch(y){o.e(y)}finally{o.f()}var l,u=document.querySelectorAll(".submissions tbody tr"),d=(0,c.Z)(u);try{for(d.s();!(l=d.n()).done;){l.value.addEventListener("click",f)}}catch(y){d.e(y)}finally{d.f()}return function(){var e,n=(0,c.Z)(t);try{for(n.s();!(e=n.n()).done;){e.value.removeEventListener("click",p)}}catch(y){n.e(y)}finally{n.f()}var s,r=(0,c.Z)(i);try{for(r.s();!(s=r.n()).done;){s.value.removeEventListener("click",h)}}catch(y){r.e(y)}finally{r.f()}var a,o=(0,c.Z)(u);try{for(o.s();!(a=o.n()).done;){a.value.removeEventListener("click",f)}}catch(y){o.e(y)}finally{o.f()}}}function p(e){if(this.classList.contains("selected"))e.preventDefault();else{var t=[{getter:s,setter:r},{getter:m,setter:g},{getter:N,setter:I},{getter:L,setter:A}];v.call(this,e,t)}}function h(e){if(console.count("select page"),this.classList.contains("selected-page"))e.preventDefault();else{console.count("select page");var t={getters:[s,m,N,L],setters:[r,g,I,A]};b.call(this,e,t,D.array)}}}),[s,m,N,L,D.array]),(0,d.jsx)("div",{className:"Home",children:(0,d.jsxs)("main",{children:[(0,d.jsx)("section",{className:"controls",children:Z(D.array)}),(0,d.jsx)("section",{className:"submissions-info",children:x({applications:D.array,categories:[s,m,N,L]})}),(0,d.jsxs)("section",{className:"submissions-area",children:[(0,d.jsxs)("div",{className:"category-tabs",children:[(0,d.jsx)("button",{id:"category-new",className:null!==s&&void 0!==s&&s.selected?"selected":null,children:"\u0627\u0644\u062c\u062f\u064a\u062f\u0629"}),(0,d.jsx)("button",{id:"category-accepted",className:null!==m&&void 0!==m&&m.selected?"selected":null,children:"\u0627\u0644\u0645\u0642\u0628\u0648\u0644\u0629"}),(0,d.jsx)("button",{id:"category-pending",className:null!==N&&void 0!==N&&N.selected?"selected":null,children:"\u0627\u0644\u0645\u0639\u0644\u0642\u0629"}),(0,d.jsx)("button",{id:"category-rejected",className:null!==L&&void 0!==L&&L.selected?"selected":null,children:"\u0627\u0644\u0645\u0631\u0641\u0648\u0636\u0629"})]}),(0,d.jsx)("div",{className:"submission-field",children:j([s,m,N,L])})]}),y({newSubmissions:s,acceptedSubmissions:m,pendingSubmissions:N,rejectedSubmissions:L})]})})}}}]);
//# sourceMappingURL=415.6b2685af.chunk.js.map